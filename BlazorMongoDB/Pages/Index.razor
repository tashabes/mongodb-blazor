@page "/"
@using BlazorMongoDB.Data
@inject BlazorMongoDB.IService.IUserService userService
@inject NavigationManager navManager
@inject IJSRuntime jsRuntime

@code {
    private string SystemDetail;
    private string IpAddress;
    string message = string.Empty;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            SystemDetail = await jsRuntime.InvokeAsync<string>("getUserAgent");
            IpAddress = await jsRuntime.InvokeAsync<string>("ipAddressInterop.getClientIPAddress");
            var user = userService.GetUser(SystemDetail, IpAddress);
            Console.WriteLine(user);
            if (user != null)
            {
                navManager.NavigateTo("/welcome");
            }
            else
            {
                navManager.NavigateTo("/register");
            }
        }
    }
}


